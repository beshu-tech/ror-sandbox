readonlyrest:
  ssl:
    enable: true
    keystore_file: "ror-keystore.jks"
    keystore_pass: readonlyrest
    key_pass: readonlyrest

  audit:
    enabled: true
    outputs: [index]

  access_control_rules:

    - name: "KIBANA"
      type: allow
      auth_key: kibana:kibana
      verbosity: error

    - name: "Admins"
      groups: [Administrators]
      kibana:
        access: admin

    - name: "End users"
      groups: ["EndUsers"]
      indices: ["frontend_logs", "kibana_sample_data_*"]
      kibana:
        index: .kibana_end_@{user}
        access: rw
        hide_apps: ["Security", "Observability"]

    - name: "Business users"
      groups: ["BusinessUsers"]
      indices: ["business_logs", "kibana_sample_data_*"]
      kibana:
        index: .kibana_business_@{user}
        access: rw
        hide_apps: ["Security", "Observability"]

    # Requirement B (solution 1.)
    - name: "Allow RW access to all tracy-* indices"
      groups_or: ["kib_tracy_default_adm", "kib_tracy_tenant1_adm"]
      indices:
        patterns: ["deva-*", "int-*", "prs-*", "pred-*", "tracy-*"]
        must_involve_indices: true  # this has to be true otherwise user cannot login
        
    # Requirement A
    - name: kib_tracy_default_adm
      groups_or: ["kib_tracy_default_adm"]
      indices: ["deva-*", "int-*", "prs-*", "pred-*", "tracy-*"]
      kibana:
        access: rw
        index: ".kibana_tracy_default"

    # Requirement A
    - name: kib_tracy_tenant1_adm
      groups_or: ["kib_tracy_tenant1_adm"]
      indices: ["deva-*", "int-*", "prs-*", "pred-*", "tracy-*"]
      kibana:
        access: rw
        index: ".kibana_tracy_tenant1"

    # Requirement B (solution 2: alternative to solution 1)
    #- name: "Allow RW access to all tracy-* indices"
    #  groups_or: ["kib_tracy_default_adm", "kib_tracy_tenant1_adm"]
    #  indices: ["deva-*", "int-*", "prs-*", "pred-*", "tracy-*"]

  users:
    - username: admin
      auth_key: admin:admin
      groups:
        - id: "Administrators"
          name: "Administrators"
        - id: "EndUsers"
          name: "End Users"
        - id: "BusinessUsers"
          name: "Business Users"

    - username: user1
      auth_key: user1:test
      groups:
        - id: "EndUsers"
          name: "End Users"
        - id: "BusinessUsers"
          name: "Business Users"

    - username: user2
      auth_key: user2:test
      groups:
        - id: "EndUsers"
          name: "End Users"

    - username: adm3
      auth_key: adm3:test
      groups:
        - id: "kib_tracy_default_adm"
          name: "kib_tracy_default_adm"
        - id: "kib_tracy_tenant1_adm" 
          name: "kib_tracy_tenant1_adm"
