readonlyrest:

  audit:
    enabled: true
    outputs: [index]

  access_control_rules:

    - name: "KIBANA"
      type: allow
      auth_key: kibana:kibana
      verbosity: error

    - name: "Admins"
      auth_key: admin:admin
      verbosity: error

    - name: "huh, weird, need to permit certain stuff on async_search"
      actions: [ "indices:data/read/async_search/delete", "indices:data/read/async_search/get", "indices:data/read/close_point_in_time" ]
      type: allow

    - name: "Permit specific group to MandR firewall logs"
      ldap_authentication:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchMandRLogs" ]
      indices: ["mandr-*"]
      actions: ["indices:data/read/*"]
      type: allow

    - name: "Deny everyone else to MandR"
      indices: ["mandr-*"]
      actions: ["indices:data/read/*"]
      type: forbid




    - name: "Permit specific group to QIM firewall logs"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchQIMFirewallLogs" ]
      indices: ["qim-paloaltonew-*"]
      actions: ["indices:data/read/*"]
      type: allow

    - name: "Deny everyone else to QIM firewall logs"
      indices: ["qim-paloaltonew-*"]
      actions: ["indices:data/read/*"]
      type: forbid




    - name: "Permit specific group to Cipher app logs"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchCipherLogs" ]
      indices: ["cipherlogs-*"]
      actions: ["indices:data/read/*"]
      type: allow

    - name: "Deny everyone else to Cipher app logs"
      indices: ["cipherlogs-*"]
      actions: ["indices:data/read/*"]
      type: forbid

    - name: "ElasticsearchRestrictedDashboardOnly group member 1 of 2"
      ldap_authentication:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchRestrictedDashboardOnly" ]
      indices: ["*"]
      kibana_access: ro
      kibana_hide_apps: [ "Observability", "Management", "ROR Manage Kibana",  "ROR Security Settings"  ]

    - name: "ElasticsearchRestrictedDashboardOnly group member 2 of 2"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchRestrictedDashboardOnly" ]
      indices: ["*"]
      actions: ["*"]



    - name: "ElasticsearchSuperUsers group 1 of 2"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchSuperUsers" ]
      indices: ["*"]
      kibana_access: rw
      kibana_hide_apps: [ "ROR Security Settings" ]

    - name: "ElasticsearchSuperUsers group 2 of 2"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchSuperUsers" ]
      indices: ["*"]
      actions: ["*"]



    - name: "ElasticsearchReadAllIndices group 1 of 2"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchReadAllIndices" ]
      indices: ["*"]
      kibana_access: rw
      kibana_hide_apps: [ "ROR Security Settings" ]

    - name: "ElasticsearchReadAllIndices group 2 of 2"
      ldap_auth:
        name: "ourQIMdomain"
        groups: [ "ElasticsearchReadAllIndices" ]
      indices: ["*"]
      actions: ["indices:data/read/*","cluster:monitor/*", "cluster:admin/rradmin/refreshsettings"]

  ldaps:

    - name: ourQIMdomain
      host: ldap
      port: 389
      ssl_enabled: false                                        # default true
      ssl_trust_all_certs: true                                 # default false
      bind_dn: "cn=admin,dc=example,dc=com"                     # skip for anonymous bind
      bind_password: "password"                                 # skip for anonymous bind
      connection_pool_size: 10                                  # default 30
      connection_timeout: 10s                                   # default 1
      request_timeout: 10s                                      # default 1
      cache_ttl: 60s                                            # default 0 - cache disabled
      search_user_base_DN: "dc=example,dc=com"
      search_groups_base_DN: "dc=example,dc=com"
      user_id_attribute: "uid"                              
      unique_member_attribute: "uniqueMember"                             
      group_search_filter: "(cn=*)"                                 
      group_name_attribute: "cn"  
      nested_groups_depth: 3