readonlyrest:

  access_control_rules:

    - name: "KIBANA"
      type: allow
      auth_key: kibana:kibana
      verbosity: error

    - name: "ADMIN"
      type: allow
      verbosity: error
      auth_key: admin:admin
      kibana:
        access: admin

    - name: "::USER2 INDEX SEGMENTATION::"
      auth_key: user2:dev
      indices: [ "ror_poc_001" ]
      filter: '{"bool": { "must": { "match": { "username": "user2" }}}}'

    - name: "user2"
      type: allow
      verbosity: error
      auth_key: user2:dev
      kibana:
        access: rw

    - name: "::PER-USER INDEX SEGMENTATION::"
      indices: ["ror_poc_001"]
      users: ["user1"]
      filter: '{"bool": { "must": { "match": { "username": "@{user}" }}}}'
      jwt_auth:
        name: "jwt_provider_1"

    - name: Valid JWT token with a writer group
      kibana:
        access: rw
      users: ["user1"]
      jwt_auth:
        name: "jwt_provider_1"

  jwt:
    - name: jwt_provider_1
      signature_algo: HMAC # can be NONE, RSA, HMAC (default), and EC
      signature_key: "608c76e4bf65bb25c33369119594bad57273cefa13d463d788d487af89f183f8"
      user_claim: name
