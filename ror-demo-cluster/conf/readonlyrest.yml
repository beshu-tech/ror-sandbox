readonlyrest:

  access_control_rules:

    - name: "KIBANA"
      type: allow
      auth_key: kibana:kibana
      verbosity: error

    # Allow ANY jwt user to read his own data
    - name: "::USER SEGMENTATION::"
      users: [ "*" ] # Optional, if you want to restrict users by name prefix, suffix, etc.
      # Can filter also by group name, any string within the JWT claims! Here I am using the username
      filter: '{"bool": { "must": { "match": { "username": "@{acl:user}" }}}}'
      jwt_auth:
        name: "jwt_provider_1"

    # Allow JWT users to read all system Kibana indices without DLS, otherwise Kibana breaks
    - name: "::UNFILTERED SYSTEM INDICES FOR USR*::"
      users: [ "*" ] # Optional, if you want to restrict users by name prefix, suffix, etc.
      kibana:
        access: rw
      jwt_auth:
        name: "jwt_provider_1"
      
  jwt:
    - name: jwt_provider_1
      signature_algo: HMAC # can be NONE, RSA, HMAC (default), and EC
      signature_key: "608c76e4bf65bb25c33369119594bad57273cefa13d463d788d487af89f183f8"
      user_claim: name
