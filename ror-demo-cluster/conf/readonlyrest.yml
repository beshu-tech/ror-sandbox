helpers:
  cr: &common-rules
    verbosity: error
    kibana_access: rw
    kibana_hide_apps: [ "Enterprise Search|Overview", "Observability" ]
    kibana_index: ".kibana_@{acl:current_group}"

  ag: &all-groups
    groups: [administrators, infosec, template]


readonlyrest:
  response_if_req_forbidden: Forbidden by ReadonlyREST ES plugin
  prompt_for_basic_auth: false
  audit:
    enabled: true
    outputs:
      - type: index
        serializer: tech.beshu.ror.requestcontext.QueryAuditLogSerializer
        index_template: "'readonlyrest_audit-'-yyyy-MM-dd"

  access_control_rules:
    - name: KIBANA_SERVER
      auth_key: kibana:kibana
      verbosity: info

    - name: PERSONAL_GRP
      groups: [ Personal ]
      <<: *common-rules
      kibana_index: '.kibana_@{user}'

    - name: ADMIN_GRP
      groups: [ administrators ]
      <<: *common-rules
      kibana_access: admin

    #  - name: infosec4search
    #    groups: [ infosec ]
    #    indices: ["readonlyrest_audit*"]
    #    #filter: '{"bool": { "must_not": { "match": { "type": "xxxx" }}}}'
    #    kibana_index: .kibana_infosec
    #    verbosity: error

    - name: infosec
      groups: [ infosec ]
      <<: *common-rules
      kibana_hide_apps: [ "Enterprise Search|Overview", "Observability", "Management" ]

    - name: Template Tenancy
      groups: [ template ]
      <<: *common-rules

    - name: "ReadonlyREST Enterprise instance #1"
      kibana_index: ".kibana_external_auth"
      ror_kbn_auth:
        name: "kbn1"

  # USERS TO GROUPS ############
  users:
    - username: admin
      auth_key: admin:admin
      <<: *all-groups

    - username: user1
      auth_key: user1:test
      <<: *all-groups

  ror_kbn:
    - name: kbn1
      signature_key: "9yzBfnLaTYLfGPzyKW9es76RKYhUVgmuv6ZtehaScj5msGpBpa5FWpwk295uJYaaffTFnQC5tsknh2AguVDaTrqCLfM5zCTqdE4UGNL73h28Bg4dPrvTAFQyygQqv4xfgnevBED6VZYdfjXAQLc8J8ywaHQQSmprZqYCWGE6sM3vzNUEWWB3kmGrEKa4sGbXhmXZCvL6NDnEJhXPDJAzu9BMQxn8CzVLqrx6BxDgPYF8gZCxtyxMckXwCaYXrxAGbjkYH69F4wYhuAdHSWgRAQCuWwYmWCA6g39j4VPge5pv962XYvxwJpvn23Y5KvNZ5S5c6crdG4f4gTCXnU36x92fKMQzsQV9K4phcuNvMWkpqVB6xMA5aPzUeHcGytD93dG8D52P5BxsgaJJE6QqDrk3Y2vyLw9ZEbJhPRJxbuBKVCBtVx26Ldd46dq5eyyzmNEyQGLrjQ4qd978VtG8TNT5rkn4ETJQEju5HfCBbjm3urGLFVqxhGVawecT4YM9Rry4EqXWkRJGTFQWQRnweUFbKNbVTC9NxcXEp6K5rSPEy9trb5UYLYhhMJ9fWSBMuenGRjNSJxeurMRCaxPpNppBLFnp8qW5ezfHgCBpEjkSNNzP4uXMZFAXmdUfJ8XQdPTWuYfdHYc5TZWnzrdq9wcfFQRDpDB2zX5Myu96krDt9vA7wNKfYwkSczA6qUQV66jA8nV4Cs38cDAKVBXnxz22ddAVrPv8ajpu7hgBtULMURjvLt94Nc5FDKw79CTTQxffWEj9BJCDCpQnTufmT8xenywwVJvtj49yv2MP2mGECrVDRmcGUAYBKR8G6ZnFAYDVC9UhY46FGWDcyVX3HKwgtHeb45Ww7dsW8JdMnZYctaEU585GZmqTJp2LcAWRcQPH25JewnPX8pjzVpJNcy7avfA2bcU86bfASvQBDUCrhjgRmK2ECR6vzPwTsYKRgFrDqb62FeMdrKgJ9vKs435T5ACN7MNtdRXHQ4fj5pNpUMDW26Wd7tt9bkBTqEGf"

  impersonation:
    - impersonator: admin
      users: ["*"]
      auth_key: admin:admin
